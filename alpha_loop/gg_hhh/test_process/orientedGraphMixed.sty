<prologue>


<diagram>
**NewDiagram**
<<|
<back>"edges"->>{
<back><in_loop>in[[<in_index>]]
<back>->>v[[<vertex_index>]],
<back><end>
<back><out_loop>v[[<vertex_index>]]
<back>->>out[[<out_index>]],
<back><end>
<back><propagator_loop>v[[<dual-vertex_index>]]
<back>->>v[[<vertex_index>]],
<back><end>
<back><back>},
<back>"particleType"->>{
<back><in_loop>in[[<field>[[<momentum>]]]],
<back><end>
<back><out_loop>out[[<field>[[<momentum>]]]],
<back><end>
<back><propagator_loop><field>,
<back><end>
<back><back>},
<back>"momentumMap"->>{
<back><in_loop>in[[<momentum>]],
<back><end>
<back><out_loop>out[[<momentum>]],
<back><end>
<back><propagator_loop><momentum>,
<back><end>
<back><back>},
<back>"numerator"->>
<back><sign><symmetry_factor>*
<in_loop> in[[<field>[[<momentum>,<field_index>]] ]]*
<end><out_loop> out[[ <field>[[<momentum>,<field_index>]] ]]*
<end><propagator_loop>
<back>prop[[<field>[[<momentum>,{<field_index>,<dual-field_index>}]] ]]*
<end><back>
<vertex_loop> v [[ <ray_loop>
<back><field>[[<momentum>,<field_index> ]],
<back><end><back>]]*
<end><back><back>,
"PYedges"->><<|
<in_loop><field_index>+<legs>->><<|
    "name"->>"q<in_index>",
    "PDG"->> [pdg],
    "type"->> "in",
    "momentum"->> <momentum>,
    "indices"->> {<field_index>+<legs>+1},
    "vertices"->> {<field_index>+<legs>+1,
<back><vertex_index>+<legs>}
 |>>,
<end>
<back><out_loop><field_index>+<legs>->><<|
    "name"->> "q<leg_index>",
    "PDG"->> [pdg],
    "type"->> "out",
    "momentum"->> <momentum>,
    "indices"->> {<field_index>+<legs>+1},
    "vertices"->>{<vertex_index>+<legs>,
<back><field_index>+<legs>+1}
 |>>,
<end>
<back><propagator_loop><propagator_index>+<legs>->><<|
    "name"->>"p<propagator_index>",
    "PDG"->> [pdg],
    "type"->> "virtual",
    "momentum"->> "<momentum>",
    "indices"->> {<dual-field_index>+<legs>+1,
<back><field_index>+<legs>+1},
    "vertices"->>{<dual-vertex_index>+<legs>,
<back><vertex_index>+<legs>}
 |>>,
<end><back><back>
<back>
|>>,
"PYnodes"->><<|
<in_loop> <field_index>+<legs>+1->><<|
    "PDGs"->> {[pdg]},
    "momenta"->> {<momentum>},
    "indices"->> {<field_index>+<legs>+1},
    "vertex_id"->> -1,
    "edge_ids"->> {<field_index>+<legs>}
 |>>,
<back>
<end>
<back><out_loop> <field_index>+<legs>+1->><<|
    "PDGs"->> {[pdg]},
    "momenta"->> {<momentum>},
    "indices"->> {<field_index>+<legs>+1},
    "vertex_id"->> -2,
    "edge_ids"->> {<field_index>+<legs>}
 |>>,
<back>
<end>
<back><vertex_loop> <vertex_index>+<legs>->><<|
    "PDGs"->> {<ray_loop>[pdg],<end><back>},
    "momenta"->> {<ray_loop><momentum>,<end><back>},
    "indices"->> {<ray_loop><field_index>+<legs>+1,<end><back>},
    "vertex_id"->> 0,
    "edge_ids"->> {<ray_loop><propagator_index>+<legs>,<end><back>}
    |>>,
<end><back><back>
|>>,
"overall_factor"->> "<sign><symmetry_factor>",
"in_momenta"->>{
<back><in_loop><momentum>,<end><back>},
"out_momenta"->>{
<back><out_loop>"<momentum>",<end><back>}
<back>|>>

<epilogue>

<exit>
