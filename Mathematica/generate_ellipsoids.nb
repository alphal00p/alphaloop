(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     27746,        667]
NotebookOptionsPosition[     26027,        634]
NotebookOutlinePosition[     26364,        649]
CellTagsIndexPosition[     26321,        646]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"Ellipsoids", "[", 
   RowBox[{"k_", ",", "p_", ",", "m_", ",", "p0_", ",", "N_"}], "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"k", "+", 
               RowBox[{"p", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "^", "2"}], "]"}], 
           "+", " ", 
           RowBox[{"m", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "+", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"k", "+", 
               RowBox[{"p", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "^", "2"}], "]"}], 
           "+", " ", 
           RowBox[{"m", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "+", 
         RowBox[{"p0", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "-", 
         RowBox[{"p0", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "<", "0"}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"k", "+", 
               RowBox[{"p", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "^", "2"}], "]"}], 
           "+", " ", 
           RowBox[{"m", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "+", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"k", "+", 
               RowBox[{"p", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "^", "2"}], "]"}], 
           "+", " ", 
           RowBox[{"m", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", 
         RowBox[{"p0", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "+", 
         RowBox[{"p0", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "<", "0"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", "N"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"i", "+", "1"}], ",", "N"}], "}"}]}], "]"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.777874804479844*^9, 3.777874808441042*^9}, {
  3.7778749391326447`*^9, 3.7778749936611633`*^9}, {3.777875038139999*^9, 
  3.777875065669683*^9}, {3.777875208843912*^9, 3.777875225367258*^9}, {
  3.7778756863733253`*^9, 3.7778756921570253`*^9}, {3.777876548126237*^9, 
  3.7778765504166193`*^9}, {3.777876734235898*^9, 3.777876737344894*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"ea93b374-b456-4850-86c2-549d481ba651"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BoxIntegrand", "[", 
    RowBox[{
    "k_", ",", " ", "p1_", ",", "p2_", ",", "p3_", ",", " ", "p4_", ",", " ", 
     "p01_", ",", "p02_", ",", "p03_", ",", " ", "p04_"}], "]"}], ":=", 
   RowBox[{"Ellipsoids", "[", 
    RowBox[{"k", ",", 
     RowBox[{"{", 
      RowBox[{"p1", ",", 
       RowBox[{"p1", "+", "p2"}], ",", 
       RowBox[{"p1", "+", "p2", "+", "p3"}], ",", 
       RowBox[{"p1", "+", "p2", "+", "p3", "+", "p4"}], ",", " ", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", " ", "0"}], "}"}], ",", 
     
     RowBox[{"{", 
      RowBox[{"p01", ",", 
       RowBox[{"p01", "+", "p02"}], ",", 
       RowBox[{"p01", "+", "p02", "+", "p03"}], ",", " ", 
       RowBox[{"p01", "+", "p02", "+", "p03", "+", "p04"}], ",", " ", "0"}], 
      "}"}], ",", "5"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.777875081606978*^9, 3.77787517713992*^9}, {
  3.777875213053809*^9, 3.777875310327627*^9}, {3.777875410620657*^9, 
  3.7778754153134127`*^9}, {3.777876242311985*^9, 3.777876248437668*^9}, {
  3.777876325820863*^9, 3.777876377205792*^9}, {3.778242392292858*^9, 
  3.778242440416183*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"2c96f312-6eb8-429e-ac80-0078949f066a"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.777875321344863*^9, 3.777875325238205*^9}, 
   3.777875371445509*^9},ExpressionUUID->"f49d8ad2-4120-4db5-a9cb-\
383a0b3488f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CraftTopology", "[", 
   RowBox[{"defaults_", ",", "MinRange_", ",", "MaxRange_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"RegionPlot", "[", "\[IndentingNewLine]", 
         RowBox[{"#1", "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"kx", ",", 
            RowBox[{"-", "50"}], ",", "50"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"ky", ",", 
            RowBox[{"-", "50"}], ",", "50"}], "}"}]}], "\[IndentingNewLine]", 
         "]"}], "&"}], ")"}], "[", 
      RowBox[{"BoxIntegrand", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"kx", ",", "ky"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p1x", ",", "p1y"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p2x", ",", "p2y"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p3x", ",", "p3y"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p4x", ",", "p4y"}], "}"}], ",", " ", "p01", ",", "p02", ",",
         "p03", ",", " ", "p04"}], "]"}], "]"}], "\[IndentingNewLine]", "]"}],
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "Delimiter", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p01", ",", 
        RowBox[{
         RowBox[{"defaults", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<pt\>\"", "]"}]}], "}"}], 
      ",", "MinRange", ",", "MaxRange"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p1x", ",", 
        RowBox[{
         RowBox[{"defaults", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<px\>\"", "]"}]}], "}"}], 
      ",", "MinRange", ",", "MaxRange"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p1y", ",", 
        RowBox[{
         RowBox[{"defaults", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<py\>\"", "]"}]}], "}"}], 
      ",", "MinRange", ",", "MaxRange"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p02", ",", 
        RowBox[{
         RowBox[{"defaults", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<pt\>\"", "]"}]}], "}"}], 
      ",", "MinRange", ",", "MaxRange"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p2x", ",", 
        RowBox[{
         RowBox[{"defaults", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<px\>\"", "]"}]}], "}"}], 
      ",", "MinRange", ",", "MaxRange"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p2y", ",", 
        RowBox[{
         RowBox[{"defaults", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<py\>\"", "]"}]}], "}"}], 
      ",", "MinRange", ",", "MaxRange"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p03", ",", 
        RowBox[{
         RowBox[{"defaults", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "[", "\"\<pt\>\"", "]"}]}], "}"}], 
      ",", "MinRange", ",", "MaxRange"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p3x", ",", 
        RowBox[{
         RowBox[{"defaults", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "[", "\"\<px\>\"", "]"}]}], "}"}], 
      ",", "MinRange", ",", "MaxRange"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p3y", ",", 
        RowBox[{
         RowBox[{"defaults", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "[", "\"\<py\>\"", "]"}]}], "}"}], 
      ",", "MinRange", ",", "MaxRange"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p04", ",", 
        RowBox[{
         RowBox[{"defaults", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "[", "\"\<pt\>\"", "]"}]}], "}"}], 
      ",", "MinRange", ",", "MaxRange"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p4x", ",", 
        RowBox[{
         RowBox[{"defaults", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "[", "\"\<px\>\"", "]"}]}], "}"}], 
      ",", "MinRange", ",", "MaxRange"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p4y", ",", 
        RowBox[{
         RowBox[{"defaults", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "[", "\"\<py\>\"", "]"}]}], "}"}], 
      ",", "MinRange", ",", "MaxRange"}], "}"}], ",", "\[IndentingNewLine]", 
    "Delimiter", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Button", "[", 
     RowBox[{"\"\<Store Ellipses parameters\>\"", ",", 
      RowBox[{"EllipsesParameters", "=", "\[IndentingNewLine]", 
       RowBox[{"Dataset", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Association", "@", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"\"\<pt\>\"", "\[Rule]", "p01"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<px\>\"", "\[Rule]", "p1x"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<py\>\"", "\[Rule]", "p1y"}]}], 
            "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Association", "@", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"\"\<pt\>\"", "\[Rule]", "p02"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<px\>\"", "\[Rule]", "p2x"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<py\>\"", "\[Rule]", "p2y"}]}], 
            "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Association", "@", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"\"\<pt\>\"", "\[Rule]", "p03"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<px\>\"", "\[Rule]", "p3x"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<py\>\"", "\[Rule]", "p3y"}]}], 
            "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Association", "@", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"\"\<pt\>\"", "\[Rule]", "p04"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<px\>\"", "\[Rule]", "p4x"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<py\>\"", "\[Rule]", "p4y"}]}], 
            "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "}"}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.777875366264299*^9, 3.7778754019355392`*^9}, {
   3.777875446501217*^9, 3.77787558229904*^9}, {3.777875620742112*^9, 
   3.7778756747153378`*^9}, {3.7778757656942987`*^9, 3.777875775657776*^9}, {
   3.777876908613366*^9, 3.777876928368834*^9}, 3.777876974922*^9, 
   3.777877141121725*^9, {3.777877172176261*^9, 3.7778772024703207`*^9}, {
   3.77787735482353*^9, 3.7778774045606003`*^9}, {3.777877468612083*^9, 
   3.7778774827913933`*^9}, {3.777877513879757*^9, 3.777877545479065*^9}, 
   3.77787761192421*^9, {3.777877869631658*^9, 3.777877885756463*^9}, {
   3.777877934068597*^9, 3.777878067379483*^9}, {3.7778883470912943`*^9, 
   3.777888356266667*^9}, {3.7778884261654987`*^9, 3.777888593808545*^9}, {
   3.777888665971281*^9, 3.777888709141184*^9}, {3.7778887945174294`*^9, 
   3.7778887975066757`*^9}, {3.777888857308361*^9, 3.777888932565607*^9}, {
   3.777888967038477*^9, 3.777888973182823*^9}, {3.777891521044532*^9, 
   3.777891528276208*^9}, {3.777891836416748*^9, 3.777891847597324*^9}, {
   3.7778929073853903`*^9, 3.7778929373268147`*^9}, {3.7778931949487743`*^9, 
   3.777893200827057*^9}, {3.777898441392453*^9, 3.777898446742158*^9}, {
   3.778242480923451*^9, 3.778242563414505*^9}, {3.778242973070386*^9, 
   3.778242985827157*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"c526df9f-57a5-4b07-a3b0-72795d83bd9d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CraftTopology", "[", 
  RowBox[{"EllipsesParameters", ",", 
   RowBox[{"-", "60"}], ",", "60"}], "]"}]], "Input",
 CellChangeTimes->{{3.777888611025869*^9, 3.777888629370865*^9}, {
  3.777888726107576*^9, 3.777888728278878*^9}, {3.7778887601093903`*^9, 
  3.777888761787513*^9}, {3.777892292020253*^9, 3.777892296025779*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"10e94444-a0ba-401c-b4d8-e73eb8137158"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`p01$$ = 
    7.6000000000000085`, $CellContext`p02$$ = 
    6.6000000000000085`, $CellContext`p03$$ = 
    16.400000000000006`, $CellContext`p04$$ = 
    17.200000000000003`, $CellContext`p1x$$ = 
    6.400000000000006, $CellContext`p1y$$ = -3.799999999999997, \
$CellContext`p2x$$ = 
    3.6000000000000014`, $CellContext`p2y$$ = -6.199999999999996, \
$CellContext`p3x$$ = 
    8.400000000000006, $CellContext`p3y$$ = -14.199999999999996`, \
$CellContext`p4x$$ = -4., $CellContext`p4y$$ = -13.399999999999999`, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`p01$$], 7.6000000000000085`}, -60, 60}, {{
       Hold[$CellContext`p1x$$], 6.400000000000006}, -60, 60}, {{
       Hold[$CellContext`p1y$$], -3.799999999999997}, -60, 60}, {{
       Hold[$CellContext`p02$$], 6.6000000000000085`}, -60, 60}, {{
       Hold[$CellContext`p2x$$], 3.6000000000000014`}, -60, 60}, {{
       Hold[$CellContext`p2y$$], -6.199999999999996}, -60, 60}, {{
       Hold[$CellContext`p03$$], 16.400000000000006`}, -60, 60}, {{
       Hold[$CellContext`p3x$$], 8.400000000000006}, -60, 60}, {{
       Hold[$CellContext`p3y$$], -14.199999999999996`}, -60, 60}, {{
       Hold[$CellContext`p04$$], 
       Missing["NotAvailable", "pt"]}, -60, 60}, {{
       Hold[$CellContext`p4x$$], 
       Missing["NotAvailable", "px"]}, -60, 60}, {{
       Hold[$CellContext`p4y$$], 
       Missing["NotAvailable", "py"]}, -60, 60}, {
      Hold[
       Button[
       "Store Ellipses parameters", $CellContext`EllipsesParameters = Dataset[{
           
           Association[{
            "pt" -> $CellContext`p01$$, "px" -> $CellContext`p1x$$, 
             "py" -> $CellContext`p1y$$}], 
           
           Association[{
            "pt" -> $CellContext`p02$$, "px" -> $CellContext`p2x$$, 
             "py" -> $CellContext`p2y$$}], 
           
           Association[{
            "pt" -> $CellContext`p03$$, "px" -> $CellContext`p3x$$, 
             "py" -> $CellContext`p3y$$}], 
           
           Association[{
            "pt" -> $CellContext`p04$$, "px" -> $CellContext`p4x$$, 
             "py" -> $CellContext`p4y$$}]}]]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {
    360., {176., 180.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`p01$29713$$ = 
    0, $CellContext`p1x$29714$$ = 0, $CellContext`p1y$29715$$ = 
    0, $CellContext`p02$29716$$ = 0, $CellContext`p2x$29717$$ = 
    0, $CellContext`p2y$29718$$ = 0, $CellContext`p03$29719$$ = 
    0, $CellContext`p3x$29720$$ = 0, $CellContext`p3y$29721$$ = 
    0, $CellContext`p04$29722$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`p01$$ = 
        7.6000000000000085`, $CellContext`p02$$ = 
        6.6000000000000085`, $CellContext`p03$$ = 
        16.400000000000006`, $CellContext`p04$$ = 
        Missing["NotAvailable", "pt"], $CellContext`p1x$$ = 
        6.400000000000006, $CellContext`p1y$$ = -3.799999999999997, \
$CellContext`p2x$$ = 
        3.6000000000000014`, $CellContext`p2y$$ = -6.199999999999996, \
$CellContext`p3x$$ = 
        8.400000000000006, $CellContext`p3y$$ = -14.199999999999996`, \
$CellContext`p4x$$ = Missing["NotAvailable", "px"], $CellContext`p4y$$ = 
        Missing["NotAvailable", "py"]}, "ControllerVariables" :> {
        Hold[$CellContext`p01$$, $CellContext`p01$29713$$, 0], 
        Hold[$CellContext`p1x$$, $CellContext`p1x$29714$$, 0], 
        Hold[$CellContext`p1y$$, $CellContext`p1y$29715$$, 0], 
        Hold[$CellContext`p02$$, $CellContext`p02$29716$$, 0], 
        Hold[$CellContext`p2x$$, $CellContext`p2x$29717$$, 0], 
        Hold[$CellContext`p2y$$, $CellContext`p2y$29718$$, 0], 
        Hold[$CellContext`p03$$, $CellContext`p03$29719$$, 0], 
        Hold[$CellContext`p3x$$, $CellContext`p3x$29720$$, 0], 
        Hold[$CellContext`p3y$$, $CellContext`p3y$29721$$, 0], 
        Hold[$CellContext`p04$$, $CellContext`p04$29722$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Show[
        (RegionPlot[#, {$CellContext`kx, -50, 50}, {$CellContext`ky, -50, 
          50}]& )[
         $CellContext`BoxIntegrand[{$CellContext`kx, $CellContext`ky}, \
{$CellContext`p1x$$, $CellContext`p1y$$}, {$CellContext`p2x$$, \
$CellContext`p2y$$}, {$CellContext`p3x$$, $CellContext`p3y$$}, \
{$CellContext`p4x$$, $CellContext`p4y$$}, $CellContext`p01$$, \
$CellContext`p02$$, $CellContext`p03$$, $CellContext`p04$$]]], 
      "Specifications" :> {
       Delimiter, {{$CellContext`p01$$, 7.6000000000000085`}, -60, 
         60}, {{$CellContext`p1x$$, 6.400000000000006}, -60, 
         60}, {{$CellContext`p1y$$, -3.799999999999997}, -60, 
         60}, {{$CellContext`p02$$, 6.6000000000000085`}, -60, 
         60}, {{$CellContext`p2x$$, 3.6000000000000014`}, -60, 
         60}, {{$CellContext`p2y$$, -6.199999999999996}, -60, 
         60}, {{$CellContext`p03$$, 16.400000000000006`}, -60, 
         60}, {{$CellContext`p3x$$, 8.400000000000006}, -60, 
         60}, {{$CellContext`p3y$$, -14.199999999999996`}, -60, 
         60}, {{$CellContext`p04$$, 
          Missing["NotAvailable", "pt"]}, -60, 60}, {{$CellContext`p4x$$, 
          Missing["NotAvailable", "px"]}, -60, 60}, {{$CellContext`p4y$$, 
          Missing["NotAvailable", "py"]}, -60, 60}, Delimiter, 
        Button[
        "Store Ellipses parameters", $CellContext`EllipsesParameters = 
         Dataset[{
            
            Association[{
             "pt" -> $CellContext`p01$$, "px" -> $CellContext`p1x$$, 
              "py" -> $CellContext`p1y$$}], 
            
            Association[{
             "pt" -> $CellContext`p02$$, "px" -> $CellContext`p2x$$, 
              "py" -> $CellContext`p2y$$}], 
            
            Association[{
             "pt" -> $CellContext`p03$$, "px" -> $CellContext`p3x$$, 
              "py" -> $CellContext`p3y$$}], 
            
            Association[{
             "pt" -> $CellContext`p04$$, "px" -> $CellContext`p4x$$, 
              "py" -> $CellContext`p4y$$}]}]]}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{641., {206., 212.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.777888629896537*^9, 3.777888678997243*^9, 3.777888729004537*^9, {
   3.77788876299757*^9, 3.777888778987316*^9}, {3.7778889554026117`*^9, 
   3.777889002219501*^9}, 3.7778905610202427`*^9, 3.777891535922995*^9, 
   3.7778918596693287`*^9, 3.777892296920339*^9, {3.777892920058489*^9, 
   3.7778929408008413`*^9}, 3.777893205937262*^9, 3.778242572217383*^9, 
   3.778242619396144*^9, 3.778242721815037*^9, 3.77824293242605*^9, 
   3.7782429913095217`*^9, 3.778243047241685*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"3ae9ff1c-3046-4412-b489-358cf9831135"]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.777888679274765*^9},ExpressionUUID->"8f36076f-2199-4f10-b2a0-\
d205d3873af9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EllipsesParameters", "//", "InputForm"}]], "Input",
 CellChangeTimes->{{3.777877701290161*^9, 3.77787770343289*^9}, 
   3.777878327430005*^9, {3.7778882348741007`*^9, 3.777888237950564*^9}, {
   3.777888375089074*^9, 3.777888389360664*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"084f1381-ba69-4eda-b8ee-112310759afc"],

Cell["\<\
Dataset[{<|\"pt\" -> 7.6000000000000085, \"px\" -> 6.400000000000006, \"py\" \
-> -3.799999999999997|>, <|\"pt\" -> 6.6000000000000085, \"px\" -> \
3.6000000000000014, \"py\" -> -6.199999999999996|>, 
  <|\"pt\" -> 16.400000000000006, \"px\" -> 8.400000000000006, \"py\" -> \
-14.199999999999996|>, <|\"pt\" -> 17.200000000000003, \"px\" -> -4., \"py\" \
-> -13.399999999999999|>}, 
 TypeSystem`Vector[TypeSystem`Struct[{\"pt\", \"px\", \"py\"}, \
{TypeSystem`Atom[Real], TypeSystem`Atom[Real], TypeSystem`Atom[Real]}], 4], \
<|\"ID\" -> 33513810537824|>]\
\>", "Output",
 CellChangeTimes->{
  3.778242944089631*^9, {3.778243068434589*^9, 3.778243137382965*^9}},
 CellLabel->
  "Out[28]//InputForm=",ExpressionUUID->"311f852d-55cc-46d5-a2e6-\
c1807d70579f"]
}, Open  ]],

Cell["", "Input",
 CellChangeTimes->{{3.777891065935088*^9, 3.777891102342078*^9}, {
  3.7782430876274233`*^9, 
  3.7782430882430487`*^9}},ExpressionUUID->"8d318af6-5493-4da9-a2a1-\
42d86355b1c0"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.777876648279511*^9, 3.777876692661251*^9}, 
   3.777876839595894*^9, 
   3.777877326217362*^9},ExpressionUUID->"468943c1-f5b0-4081-9949-\
33efd5e926ed"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.777877327781931*^9, 
  3.777877329279492*^9}},ExpressionUUID->"c3c1d0ab-5234-4bc6-a4c0-\
d38546f95fdf"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"e", "[", 
    RowBox[{"p1_", ",", "p2_", ",", "k_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"k", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "+", 
          RowBox[{"p1", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"k", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "+", 
          RowBox[{"p1", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "^", "2"}]}], ")"}], 
     "]"}], "+", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"k", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "+", 
          RowBox[{"p2", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"k", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "+", 
          RowBox[{"p2", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "^", "2"}]}], ")"}], 
     "]"}], "-", 
    RowBox[{"p1", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "+", 
    RowBox[{"p2", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"e", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.8", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.777876837530908*^9, 3.777876844013509*^9}, {
  3.777890733730324*^9, 3.7778909480365047`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"86229c37-2e66-4c94-aae5-67312169c0b6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "0.5`"}], "+", 
  SqrtBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"0.8`", "\[VeryThinSpace]", "+", "x"}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", "y"}], ")"}], "2"]}]], "+", 
  SqrtBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", "x"}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", "y"}], ")"}], "2"]}]]}]], "Output",
 CellChangeTimes->{3.777890948906396*^9},
 CellLabel->"Out[36]=",ExpressionUUID->"a35d7714-33bf-472a-b53a-bdf2324070d1"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.777877792125751*^9, 3.777877794410499*^9}, {
   3.77789071974863*^9, 3.777890719908798*^9}, {3.7778909658536987`*^9, 
   3.777891080539886*^9}, {3.777892176352789*^9, 3.777892190799554*^9}, 
   3.778242882784174*^9},ExpressionUUID->"4adf9ab4-d027-45cc-b3df-\
90a11bc10322"]
},
WindowSize->{1601, 869},
WindowMargins->{{Automatic, 0}, {Automatic, 11}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2841, 76, 73, "Input",ExpressionUUID->"ea93b374-b456-4850-86c2-549d481ba651"],
Cell[3402, 98, 1283, 29, 52, "Input",ExpressionUUID->"2c96f312-6eb8-429e-ac80-0078949f066a"],
Cell[4688, 129, 175, 3, 30, "Input",ExpressionUUID->"f49d8ad2-4120-4db5-a9cb-383a0b3488f5"],
Cell[4866, 134, 8332, 194, 1060, "Input",ExpressionUUID->"c526df9f-57a5-4b07-a3b0-72795d83bd9d"],
Cell[CellGroupData[{
Cell[13223, 332, 428, 7, 30, "Input",ExpressionUUID->"10e94444-a0ba-401c-b4d8-e73eb8137158"],
Cell[13654, 341, 7565, 148, 437, "Output",ExpressionUUID->"3ae9ff1c-3046-4412-b489-358cf9831135"]
}, Open  ]],
Cell[21234, 492, 147, 3, 52, "Input",ExpressionUUID->"8f36076f-2199-4f10-b2a0-d205d3873af9"],
Cell[CellGroupData[{
Cell[21406, 499, 343, 5, 30, "Input",ExpressionUUID->"084f1381-ba69-4eda-b8ee-112310759afc"],
Cell[21752, 506, 767, 15, 81, "Output",ExpressionUUID->"311f852d-55cc-46d5-a2e6-c1807d70579f"]
}, Open  ]],
Cell[22534, 524, 196, 4, 30, "Input",ExpressionUUID->"8d318af6-5493-4da9-a2a1-42d86355b1c0"],
Cell[22733, 530, 201, 4, 30, "Input",ExpressionUUID->"468943c1-f5b0-4081-9949-33efd5e926ed"],
Cell[22937, 536, 152, 3, 30, "Input",ExpressionUUID->"c3c1d0ab-5234-4bc6-a4c0-d38546f95fdf"],
Cell[CellGroupData[{
Cell[23114, 543, 1853, 57, 73, "Input",ExpressionUUID->"86229c37-2e66-4c94-aae5-67312169c0b6"],
Cell[24970, 602, 613, 20, 41, "Output",ExpressionUUID->"a35d7714-33bf-472a-b53a-bdf2324070d1"]
}, Open  ]],
Cell[25598, 625, 425, 7, 115, "Input",ExpressionUUID->"4adf9ab4-d027-45cc-b3df-90a11bc10322"]
}
]
*)

(* End of internal cache information *)

